{
  "hash": "eb2ad5ed6d81c965744202ce2e7bf568",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"sales\"\nformat: html\n---\n\n\n\n# Analysis of Sales Data\n\n\n\n### Monthly Sales from Dec 2010 to Dec 2011\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_for_sales_graph <- categoried_sales_transaction %>% \n  filter(!category %in% c(\"transportation cost\",\"business\")) %>% \n  save_function(., name = \"list_of_goods_sold\", type = \"rds\", return = T) %>% \n  group_by(month_year) %>% \n  mutate(\n    total_sales = sum(UnitPrice*Quantity)\n  ) %>%\n  ungroup %>% \n  select(month_year, total_sales, Quantity) %>%\n  distinct() %>% \n  month_year_range(data=.,col_name = month_year, \"2010-12-01\", \"2011-12-01\") \n\n\np1<- ggplot(data_for_sales_graph, aes(x = month_year)) +\n  geom_col(aes(y = Quantity, fill = \"Quantity\"), show.legend = TRUE) +\n  geom_line(aes(y = total_sales/10, color = \"Total Sales\"), size = 1, group = 1, show.legend = TRUE) + \n  scale_y_continuous(\n    name = \"Quantity\",\n    limits = c(0,200000),\n    labels = label_number(scale = 1e-3, suffix = \"K\"),\n    sec.axis = sec_axis(~ .*10,\n                        name = \"Total Sales\",\n                        labels = label_number(scale = 1e-6, suffix = \"M\"))\n  ) +\n  theme_ipsum(base_family = \"\") +\n  scale_fill_manual(name = \"\", values = c(\"Quantity\" = \"#A8DCAB\"))+\n  scale_color_manual(name = \"\", values = c(\"Total Sales\" = \"grey\")) +\n    geom_text(\n      aes(\n        y = total_sales / 10, \n        label = paste0(round(total_sales/1000000,2),\" M\")\n        ),\n      color = \"grey40\", \n      vjust = -0.5, \n      size = 3) +\n  theme(\n    axis.text.x = element_text(angle = 45, vjust = 0.5),\n    legend.position = \"bottom\",\n    plot.title = element_text(size = 12)\n  )+\n  labs(\n    title = \"Total Sales and Quantity Sold for period Dec 2010 to Dec 2011\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nâ„¹ Please use `linewidth` instead.\n```\n\n\n:::\n\n```{.r .cell-code}\np1\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- data_for_sales_graph %>% \n  select(month_year, total_sales) %>% \n  distinct() %>% \n  ggplot(\n    aes(\n      x = \"\",\n      y = total_sales\n    )\n  )+\n  geom_boxplot(\n    outlier.shape = NA,\n    fill = custom_green,\n    width = 0.5\n  )+\n  geom_jitter(\n      width =0.1,\n      alpha =0.7,\n      size =2\n  )+\n  labs(\n    title = \"Sales Variation Across Months\"\n  )+\n  theme_ipsum(base_family = \"\")+\n  scale_y_continuous_function(\n    suffix = M\n  )+\n  theme_function(\n    title_size = 12\n  )\n\np2\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\ndata_for_sales_graph\n\n1.  data_for_sales_graphGraph above shows business has total revenue 9.58 MIL in calender year 2011.\n2.  Graph above shows total sales is gradually increase from Dec 2010 and reach the peak in Nov 2011.\n3.  Total Sales does not seem to have a positive relationship with Quantity Sold as Quantity Sold increase does not result increment in total Sales. It might caused by either, higher discount for products or product with cheaper price run fast in the month.\n\n## Total Quantity Sold And Stock Return by Category\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsold_data<- categoried_sales_transaction %>% \n  group_by(category) %>% \n  mutate(\n    total_quantity = sum(Quantity),\n    type = \"Sold\"\n  ) %>% \n  select(category,type, total_quantity) %>% \n  distinct() \n  \nranking <- c(\"NA\",\"wear\",\"house decoration\",\"toy\",\"stationary\",\"kitchen\",\"Misc\")\n\nmerged(\n  dataset1 = read_file(data_base = \"sales_return.rds\"),\n  dataset2 = category,\n  col_name = StockCode\n) %>% \n  filter(!StockCode == \"D\") %>%  #remove discount\n  group_by(category) %>% \n  mutate(\n    total_quantity = abs(sum(Quantity)),\n    type = \"Return\"\n  ) %>% \n  select(category,type, total_quantity) %>% \n  distinct() %>% \n  bind_rows(., sold_data) %>% \n  filter(!category %in% c(\"transportation cost\",\"business\")) %>% \n  mutate(\n    category = case_when(\n      is.na(category)~\"NA\",\n      T ~ category\n    ),\n    category = factor(category, levels = ranking, order = T) \n  ) %>% \n  barchart_ggv2(.,category, total_quantity, fill = type, stack = F)+\n  coord_flip()+\n  labs(\n    title = \"Yearly Total Quantity Sold and Sales Return by Category\"\n  )+\n  theme_function(title_size = 12)+\n  #geom_text_function(repel = F, vjust = 0.5, hjust = -0.15, stack = F, label = comma(total_quantity)) +\n  scale_y_continuous_function(0,2800000,m)+\n  geom_text_function(repel = F, stack = F, vjust = 0.5, hjust = -0.25, label = comma(total_quantity))\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n1.  Graph above total sales of the company come from Misc then follow by kitchen and stationary.\n2.  Toy has the highest sales return about 91,882 unit over sales 505,391 unit compare to others category. Further investigation should be carried to find out reason of sales return.\n3.  Excluding Toy, other categories have relative low percentage of sales return. However, it shouldn't be taking lightly and find out reason behind the sales return.\n\n## Potential lost due to Lost of Goods\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#opportunity revenue per stock\ncost_per_unit <- categoried_sales_transaction %>% \n  select(StockCode,Description, Quantity, category, UnitPrice) %>% \n  filter(!category %in% c(\"business\",\"transportation cost\")) %>% \n  group_by(StockCode) %>% \n  mutate(\n    total_price = sum(UnitPrice*Quantity),\n    total_unit = sum(Quantity),\n    Price_Per_Unit = round(total_price/total_unit,2)\n  ) %>% \n  select(StockCode, Price_Per_Unit) %>% \n  unique()\n\nmerged(\n    read_file(data_base = \"lostgood.rds\"),\n    cost_per_unit,\n    col_name = StockCode) %>% \n    drop_na() %>% \n    group_by(month_year, category) %>% \n    mutate(\n      total_lost = sum(total*Price_Per_Unit)\n    ) %>% \n    select(month_year, category, total_lost) %>% \n    ungroup() %>% \n    unique() %>% \n    filter(category == \"stationary\") %>% \n    month_year_range(., month_year, \"2010-12-01\",\"2011-12-01\") %>%\n      barchart_ggv2(\n      data = .,month_year,total_lost,bar_color = custom_green)+\n    theme_function(\n      title_size = 12,\n      x_label_position = element_text(angle = 45, vjust = 0.5)\n    )+\n    geom_text_function(repel = F, vjust = -0.25, label = comma(total_lost))+\n  labs(\n    title = \"Estimate lost for Missing Stationary From Dec 2010 to Dec 2011\"\n  )+\n  scale_y_continuous_function(0, 4000,suffix = k)\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged(\n    read_file(data_base = \"lostgood.rds\"),\n    cost_per_unit,\n    col_name = StockCode) %>% \n    drop_na() %>% \n    group_by(month_year, category) %>% \n    mutate(\n      total_lost = sum(total*Price_Per_Unit)\n    ) %>% \n    select(month_year, category, total_lost) %>% \n    ungroup() %>% \n    unique() %>% \n    filter(category == \"kitchen\") %>% \n    month_year_range(., month_year, \"2010-12-01\",\"2011-12-01\") %>% \n   barchart_ggv2(., month_year, total_lost, bar_color = custom_green)+\n    theme_function(\n      title_size = 12,\n      x_label_position = element_text(angle = 45, vjust = 0.5)\n    )+\n    geom_text_function(repel = F, vjust = -0.25, label = comma(total_lost))+\n  labs(\n    title = \"Estimate lost for Missing Kitchen Goods From Dec 2010 to Dec 2011\"\n  )+\n  scale_y_continuous_function(0, 12000,suffix = k)\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged(\n    read_file(data_base = \"lostgood.rds\"),\n    cost_per_unit,\n    col_name = StockCode) %>% \n    drop_na() %>% \n    group_by(month_year, category) %>% \n    mutate(\n      total_lost = sum(total*Price_Per_Unit)\n    ) %>% \n    select(month_year, category, total_lost) %>% \n    ungroup() %>% \n    unique() %>% \n    filter(category == \"Misc\") %>% \n    month_year_range(., month_year, \"2010-12-01\",\"2011-12-01\") %>% \n   barchart_ggv2(., month_year, total_lost, bar_color = custom_green)+\n    theme_function(\n      title_size = 12,\n      x_label_position = element_text(angle = 45, vjust = 0.5)\n    )+\n    geom_text_function(repel = F, vjust = -0.25, label = comma(total_lost))+\n  labs(\n    title = \"Estimate lost for Missing Misc Goods From Dec 2010 to Dec 2011\"\n  )+\n  scale_y_continuous_function(0, 12500,suffix = k)\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged(\n    read_file(data_base = \"lostgood.rds\"),\n    cost_per_unit,\n    col_name = StockCode) %>% \n    drop_na() %>% \n    group_by(month_year, category) %>% \n    mutate(\n      total_lost = sum(total*Price_Per_Unit)\n    ) %>% \n    select(month_year, category, total_lost) %>% \n    ungroup() %>% \n    unique() %>% \n    filter(category == \"house decoration\") %>% \n    month_year_range(., month_year, \"2010-12-01\",\"2011-12-01\") %>% \n    barchart_ggv2(., month_year, total_lost, bar_color = custom_green)+\n    theme_function(\n      title_size = 12,\n      x_label_position = element_text(angle = 45, vjust = 0.5)\n    )+\n    geom_text_function(repel = F, vjust = -0.25, label = comma(total_lost))+\n  labs(\n    title = \"Estimate lost for Missing House Decoration Goods From Dec 2010 to Dec 2011\"\n  )+\n  scale_y_continuous_function(0, 10000,suffix = k)\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged(\n    read_file(data_base = \"lostgood.rds\"),\n    cost_per_unit,\n    col_name = StockCode) %>% \n    drop_na() %>% \n    group_by(month_year, category) %>% \n    mutate(\n      total_lost = sum(total*Price_Per_Unit)\n    ) %>% \n    select(month_year, category, total_lost) %>% \n    ungroup() %>% \n    unique() %>% \n    filter(category == \"toy\") %>% \n    month_year_range(., month_year, \"2010-12-01\",\"2011-12-01\") %>% \n   barchart_ggv2(., month_year, total_lost, bar_color = custom_green)+\n    theme_function(\n      title_size = 12,\n      x_label_position = element_text(angle = 45, vjust = 0.5)\n    )+\n    geom_text_function(repel = F, vjust = -0.25, label = comma(total_lost))+\n  labs(\n    title = \"Estimate lost for Missing Toy From Dec 2010 to Dec 2011\"\n  )+\n  scale_y_continuous_function(0, 5000,suffix = k)\n```\n\n::: {.cell-output-display}\n![](sales_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nthrown <- read_file(\"thrown.rds\") %>% \n  select(StockCode, category, total) %>% \n  unique()\n\nmerged(\n  thrown,\n  cost_per_unit,\n  col_name = StockCode\n) %>% \n  merged(\n    .,\n    category,\n    col_name = StockCode\n  ) %>% \n  filter(if_any(everything(), is.na))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  StockCode category.x total Price_Per_Unit Description category.y\n1     23059     Thrown  2376             NA        <NA>       <NA>\n2    35611B     Thrown    27             NA        <NA>       <NA>\n3    72140F     Thrown  5368             NA        <NA>       <NA>\n4     72732     Thrown  2472             NA        <NA>       <NA>\n5     72759     Thrown   524             NA        <NA>       <NA>\n6    84611B     Thrown  1430             NA        <NA>       <NA>\n7    84612B     Thrown   162             NA        <NA>       <NA>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Product Code below dont have Price per unit in record\n```\n:::\n\n\n### Potential Lost from Thrown Goods\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged(\n  thrown,\n  cost_per_unit,\n  col_name = StockCode\n) %>% \n  merged(\n    .,\n    category,\n    col_name = StockCode\n  ) %>% \n  drop_na() %>% \n  mutate(\n    total_lost = paste0(\"$ \", comma(sum(total*Price_Per_Unit),accuracy = 0.01)),\n    total_thrown_product = paste0(sum(total), \" units\")\n  ) %>% \n  select(total_thrown_product, total_lost) %>% \n  distinct() %>% \n  t(.) %>% \n  kbl(caption = \"Potential lost from Thrown Goods\") %>% \n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Potential lost from Thrown Goods</caption>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> total_thrown_product </td>\n   <td style=\"text-align:left;\"> 36262 units </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> total_lost </td>\n   <td style=\"text-align:left;\"> $ 37,525.98 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nmerged(\n  thrown,\n  cost_per_unit,\n  col_name = StockCode\n) %>% \n  merged(\n    .,\n    category,\n    col_name = StockCode\n  ) %>% \n  drop_na() %>% \n  group_by(category.y) %>% \n  mutate(\n    total_lost_unit_by_category = comma(sum(total), accuracy = 0.01),\n    total_lost_revenue_by_category = comma(sum(total*Price_Per_Unit), accuracy = 0.01)\n  ) %>% \n  ungroup() %>% \n  select(category.y, total_lost_unit_by_category, total_lost_revenue_by_category) %>% \n  distinct() %>% \n  t(.) %>% \n  kbl(caption = \"Potential lost from Thrown Goods\") %>% \n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Potential lost from Thrown Goods</caption>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> category.y </td>\n   <td style=\"text-align:left;\"> kitchen </td>\n   <td style=\"text-align:left;\"> stationary </td>\n   <td style=\"text-align:left;\"> house decoration </td>\n   <td style=\"text-align:left;\"> Misc </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> total_lost_unit_by_category </td>\n   <td style=\"text-align:left;\"> 2,664.00 </td>\n   <td style=\"text-align:left;\"> 28,258.00 </td>\n   <td style=\"text-align:left;\"> 2,304.00 </td>\n   <td style=\"text-align:left;\"> 3,036.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> total_lost_revenue_by_category </td>\n   <td style=\"text-align:left;\"> 12,879.20 </td>\n   <td style=\"text-align:left;\"> 12,444.36 </td>\n   <td style=\"text-align:left;\"> 8,054.86 </td>\n   <td style=\"text-align:left;\"> 4,147.56 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Potential Loss from Damaged Goods\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged(\n  read_file(\"Damaged.rds\"),\n  cost_per_unit,\n  col_name = StockCode\n) %>% \n  merged(\n    .,\n    category,\n    col_name = StockCode\n  ) %>% \n  select(-CustomerID, -UnitPrice, -Quantity, -InvoiceNo,-time, -category.x, -Description.y, -category.y) %>% \n  filter(if_any(everything(),is.na))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  StockCode month_year          Description.x total Price_Per_Unit\n1    72038P   Jan 2011                damages   990             NA\n2    79323G   Oct 2011 Unsaleable, destroyed.   657             NA\n3   79323GR   Oct 2011 Unsaleable, destroyed.  1158             NA\n4   79323LP   Oct 2011 Unsaleable, destroyed.  2618             NA\n5    79323S   Oct 2011 Unsaleable, destroyed.   674             NA\n6    79323W   Oct 2011 Unsaleable, destroyed.  4830             NA\n7     79341   Oct 2011 Unsaleable, destroyed.   905             NA\n8    79342B   Oct 2011 Unsaleable, destroyed.  1128             NA\n```\n\n\n:::\n\n```{.r .cell-code}\n# Product Code below dont have Price per unit in record\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged(\n  read_file(\"Damaged.rds\"),\n  cost_per_unit,\n  col_name = StockCode\n) %>% \n  merged(\n    .,\n    category,\n    col_name = StockCode\n  ) %>% \n  select(-CustomerID) %>% \n  drop_na() %>% \n  group_by(category.y) %>% \n  mutate(\n    total_damged_unit_by_category = comma(sum(total), accuracy = 0.01),\n    total_damaged_revenue_by_category = comma(sum(total*Price_Per_Unit), accuracy = 0.01)\n  ) %>% \n  select(category.y, total_damged_unit_by_category, total_damaged_revenue_by_category) %>% \n  distinct() %>% \n  t(.) %>% \n  kbl() %>% \n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> category.y </td>\n   <td style=\"text-align:left;\"> stationary </td>\n   <td style=\"text-align:left;\"> house decoration </td>\n   <td style=\"text-align:left;\"> kitchen </td>\n   <td style=\"text-align:left;\"> Misc </td>\n   <td style=\"text-align:left;\"> toy </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> total_damged_unit_by_category </td>\n   <td style=\"text-align:left;\"> 3,717.00 </td>\n   <td style=\"text-align:left;\"> 11,687.00 </td>\n   <td style=\"text-align:left;\"> 12,565.00 </td>\n   <td style=\"text-align:left;\"> 5,955.00 </td>\n   <td style=\"text-align:left;\"> 282.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> total_damaged_revenue_by_category </td>\n   <td style=\"text-align:left;\"> 3,373.67 </td>\n   <td style=\"text-align:left;\"> 52,291.62 </td>\n   <td style=\"text-align:left;\"> 60,303.75 </td>\n   <td style=\"text-align:left;\"> 10,431.83 </td>\n   <td style=\"text-align:left;\"> 1,600.64 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n",
    "supporting": [
      "sales_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"site_libs/reactwidget-2.0.0/react-tools.js\"></script>\n<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}